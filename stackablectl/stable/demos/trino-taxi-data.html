<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>trino-taxi-data :: Stackable Documentation</title>
    <meta name="generator" content="Antora 3.1.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
    <link rel="icon" href="../../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stackable.tech"><img src="../../../_/img/stackable-logo.png"></a>
      <a class="navbar-item documentation-link" href="https://docs.stackable.tech">Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search...">
        </div>
      </div>
      <button class="navbar-burger" data-target="navbar-sub">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="https://www.stackable.tech/contact/" class="button pull-right">Contact Us</a>
    </div>
      <div id="topbar-nav" class="navbar-menu">
      </div>
      </div>
    </nav>
    <nav id="navbar-sub" class="navbar-sub">
      <div class="container">
        <a class="navbar-sub-item" href="../../../home/stable/index.html">Home</a>
<a class="navbar-sub-item" href="../../../home/stable/getting_started.html">Getting Started</a>
<a class="navbar-sub-item" href="../../../home/stable/concepts/index.html">Concepts</a>
<a class="navbar-sub-item" href="../../../home/stable/tutorials/end-to-end_data_pipeline_example.html">Tutorials</a>
<a class="navbar-sub-item" href="../index.html">stackablectl</a>
<div class="navbar-sub-item drop-down">
    Operators
    <div class="drop-down-content">
        <a class="drop-down-item" href="../../../home/stable/operators/index.html">Overview</a>
        <a class="drop-down-item" href="../../../airflow/stable/index.html">Apache Airflow</a>
        <a class="drop-down-item" href="../../../druid/stable/index.html">Apache Druid</a>
        <a class="drop-down-item" href="../../../hbase/stable/index.html">Apache HBase</a>
        <a class="drop-down-item" href="../../../hdfs/stable/index.html">Apache Hadoop HDFS</a>
        <a class="drop-down-item" href="../../../hive/stable/index.html">Apache Hive</a>
        <a class="drop-down-item" href="../../../kafka/stable/index.html">Apache Kafka</a>
        <a class="drop-down-item" href="../../../nifi/stable/index.html">Apache NiFi</a>
        <a class="drop-down-item" href="../../../spark-k8s/stable/index.html">Apache Spark on K8S</a>
        <a class="drop-down-item" href="../../../superset/stable/index.html">Apache Superset</a>
        <a class="drop-down-item" href="../../../trino/stable/index.html">Trino</a>
        <a class="drop-down-item" href="../../../zookeeper/stable/index.html">Apache ZooKeeper</a>
        <a class="drop-down-item" href="../../../opa/stable/index.html">OpenPolicyAgent</a>
        <a class="drop-down-item" href="../../../commons-operator/stable/index.html">Commons</a>
        <a class="drop-down-item" href="../../../secret-operator/stable/index.html">Secret</a>
        <a class="drop-down-item" href="../../../listener-operator/stable/index.html">Listener</a>
    </div>
</div>
<a class="navbar-sub-item" href="../../../home/stable/contributor/index.html">Contribute</a>

        <a class="arrow" href="javascript:document.querySelector('.navbar-sub').classList.toggle('open')">
          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg>
        </a>
      </div>
    </nav>
  </header>
<div class="body">
    <div class="container">
<div class="nav-container" data-component="stackablectl" data-version="nightly">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <div class="title-wrapper">
      <h3 class="title"><a href="../index.html">stackablectl</a></h3>
    </div>
    <ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Commands</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../commands/demo.html">Demo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../commands/operator.html">Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../commands/release.html">Release</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../commands/services.html">Services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../commands/stack.html">Stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Demos</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="airflow-scheduled-job.html">airflow-scheduled-job</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="data-warehouse-iceberg-trino-spark.html">data-warehouse-iceberg-trino-spark</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hbase-hdfs-load-cycling-data.html">hbase-hdfs-cycling-data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nifi-kafka-druid-earthquake-data.html">nifi-kafka-druid-earthquake-data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nifi-kafka-druid-water-level-data.html">nifi-kafka-druid-water-level-data</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="trino-taxi-data.html">trino-taxi-data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../customization.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">stackablectl</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../commons-operator/stable/index.html">Stackable Commons Operator</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../commons-operator/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../commons-operator/stable/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../../commons-operator/0.3/index.html">0.3</a>
        </li>
        <li class="version">
          <a href="../../../commons-operator/0.2/index.html">0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../home/stable/index.html">Stackable Documentation</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../home/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../home/stable/index.html">22.11</a>
        </li>
        <li class="version">
          <a href="../../../home/22.09/index.html">22.09</a>
        </li>
        <li class="version">
          <a href="../../../home/22.06/index.html">22.06</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../listener-operator/stable/index.html">Stackable Listener Operator</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../listener-operator/stable/index.html">nightly</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../airflow/stable/index.html">Stackable Operator for Apache Airflow</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../airflow/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../airflow/stable/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../airflow/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../../airflow/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../../airflow/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../druid/stable/index.html">Stackable Operator for Apache Druid</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../druid/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../druid/stable/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../../druid/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../druid/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../druid/0.2/index.html">0.2</a>
        </li>
        <li class="version">
          <a href="../../../druid/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hbase/stable/index.html">Stackable Operator for Apache HBase</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../hbase/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../hbase/stable/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../../hbase/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../../hbase/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hdfs/stable/index.html">Stackable Operator for Apache HDFS</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../hdfs/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../hdfs/stable/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../hdfs/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../../hdfs/0.4/index.html">0.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hive/stable/index.html">Stackable Operator for Apache Hive</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../hive/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../hive/stable/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../../hive/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../hive/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../kafka/stable/index.html">Stackable Operator for Apache Kafka</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../kafka/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../kafka/stable/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../../kafka/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../kafka/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../nifi/stable/index.html">Stackable Operator for Apache NiFi</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../nifi/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../nifi/stable/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../../nifi/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../nifi/0.6/index.html">0.6</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../spark-k8s/stable/index.html">Stackable Operator for Apache Spark on Kubernetes</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../spark-k8s/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../spark-k8s/stable/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../spark-k8s/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../../spark-k8s/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../../spark-k8s/0.3/index.html">0.3</a>
        </li>
        <li class="version">
          <a href="../../../spark-k8s/0.2/index.html">0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../superset/stable/index.html">Stackable Operator for Apache Superset</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../superset/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../superset/stable/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../superset/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../superset/0.5/index.html">0.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../zookeeper/stable/index.html">Stackable Operator for Apache ZooKeeper</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../zookeeper/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../zookeeper/stable/index.html">0.12</a>
        </li>
        <li class="version">
          <a href="../../../zookeeper/0.11/index.html">0.11</a>
        </li>
        <li class="version">
          <a href="../../../zookeeper/0.10/index.html">0.10</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../opa/stable/index.html">Stackable Operator for OPA</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../opa/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../opa/stable/index.html">0.11</a>
        </li>
        <li class="version">
          <a href="../../../opa/0.10/index.html">0.10</a>
        </li>
        <li class="version">
          <a href="../../../opa/0.9/index.html">0.9</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../trino/stable/index.html">Stackable Operator for Trino</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../trino/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../trino/stable/index.html">0.8</a>
        </li>
        <li class="version">
          <a href="../../../trino/0.7/index.html">0.7</a>
        </li>
        <li class="version">
          <a href="../../../trino/0.6/index.html">0.6</a>
        </li>
        <li class="version">
          <a href="../../../trino/0.5/index.html">0.5</a>
        </li>
        <li class="version">
          <a href="../../../trino/0.4/index.html">0.4</a>
        </li>
        <li class="version">
          <a href="../../../trino/0.3/index.html">0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../secret-operator/stable/index.html">Stackable Secret Operator</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../secret-operator/nightly/index.html">nightly</a>
        </li>
        <li class="version is-latest">
          <a href="../../../secret-operator/stable/index.html">0.5</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">stackablectl</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">nightly</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">stackablectl</a></li>
    <li><a href="index.html">Demos</a></li>
    <li><a href="trino-taxi-data.html">trino-taxi-data</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stackabletech/stackablectl/edit/main/docs/modules/ROOT/pages/demos/trino-taxi-data.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">trino-taxi-data</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This guide assumes that you already have the demo <code>trino-taxi-data</code> installed.
If you don&#8217;t have it installed please follow the <a href="../commands/demo.html#_install_demo" class="xref page">documentation on how to install a demo</a>.
To put it simply you have to run <code>stackablectl demo install trino-taxi-data</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This demo will</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the required Stackable operators</p>
</li>
<li>
<p>Spin up the follow data products</p>
<div class="ulist">
<ul>
<li>
<p><strong>Superset</strong>: A modern data exploration and visualization platform. This demo utilizes Superset to retrieve data from Trino via SQL queries and build dashboards on top of that data</p>
</li>
<li>
<p><strong>Trino</strong>: A fast distributed SQL query engine for big data analytics that helps you explore your data universe. This demo uses it to enable SQL access to the data</p>
</li>
<li>
<p><strong>MinIO</strong>: A S3 compatible object store. This demo uses it as persistent storage to store all the data used</p>
</li>
<li>
<p><strong>Hive metastore</strong>: A service that stores metadata related to Apache Hive and other services. This demo uses it as metadata storage for Trino</p>
</li>
<li>
<p><strong>Open policy agent</strong> (OPA): An open source, general-purpose policy engine that unifies policy enforcement across the stack. This demo uses it as the authorizer for Trino, which decides which user is able to query which data.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Load testdata into S3. It contains 2.5 years of <a href="https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page">New York City taxi trips</a></p>
</li>
<li>
<p>Make data accessible via SQL in Trino</p>
</li>
<li>
<p>Create Superset dashboards for visualization of the data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see the deployed products as well as their relationship in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/overview.png" alt="overview">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_list_deployed_stackable_services"><a class="anchor" href="#_list_deployed_stackable_services"></a>List deployed Stackable services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To list the installed installed Stackable services run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ stackablectl services list --all-namespaces
 PRODUCT   NAME         NAMESPACE  ENDPOINTS                                     EXTRA INFOS

 hive      hive         default    hive                172.18.0.5:30298
                                   metrics             172.18.0.5:31633

 opa       opa          default    http                http://172.18.0.5:30316

 superset  superset     default    external-superset   http://172.18.0.4:32295   Admin user: admin, password: admin

 trino     trino        default    coordinator-http    http://172.18.0.3:30167
                                   coordinator-metrics 172.18.0.3:31818
                                   coordinator-https   https://172.18.0.3:30141

 minio     minio-trino  default    http                http://172.18.0.3:31062   Third party service
                                   console-http        http://172.18.0.3:30503   Admin user: root, password: rootroot</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a product instance has not finished starting yet, the service will have no endpoint.
Starting all the product instances might take an considerable amount of time depending on your internet connectivity.
In case the product is not ready yet a warning might be shown.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inspect_data_in_s3"><a class="anchor" href="#_inspect_data_in_s3"></a>Inspect data in S3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The S3 provided by MinIO is used as a persistent storage to store all the data used.
You can have a look at the testdata within the MinIO web interface by opening the given <code>minio</code> endpoint <code>console-http</code> from your <code>stackablectl services list</code> command output.
You have to use the endpoint from your command output, in this case it is <a href="http://172.18.0.3:30503" class="bare">http://172.18.0.3:30503</a>.
Open it with your favorite browser.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/minio_1.png" alt="minio 1">
</div>
</div>
<div class="paragraph">
<p>Log in with the username <code>root</code> and password <code>rootroot</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/minio_2.png" alt="minio 2">
</div>
</div>
<div class="paragraph">
<p>Click on the blue button <code>Browse</code> on the bucket <code>demo</code> and open the folders <code>ny-taxi-data</code> &#8594; <code>raw</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/minio_3.png" alt="minio 3">
</div>
</div>
<div class="paragraph">
<p>As you can see the demo uploaded 1GB of parquet files, one file per month.
The data contain taxi rides in New York City.
You can see the file size (and therefore the number of rides) decrease drastically because of the Covid-19 pandemic starting from <code>2020-03</code>.
<a href="https://parquet.apache.org/">Parquet</a> is an open source, column-oriented data file format designed for efficient data storage and retrieval.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_trino_webinterface"><a class="anchor" href="#_use_trino_webinterface"></a>Use Trino webinterface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Trino offers SQL access to the data within S3.
Open the <code>trino</code> endpoint <code>coordinator-https</code> in your browser (<code><a href="https://172.18.0.3:30141" class="bare">https://172.18.0.3:30141</a></code> in this case).
If you get a warning regarding the self signed certificate (e.g. <code>Warning: Potential Security Risk Ahead</code>) you have to tell your browser to trust the website and continue.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/trino_1.png" alt="trino 1">
</div>
</div>
<div class="paragraph">
<p>Log in with the username <code>admin</code> and password <code>admin</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/trino_2.png" alt="trino 2">
</div>
</div>
<div class="paragraph">
<p>When you start executing SQL queries you will see the queries getting processed here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_superset_webinterface"><a class="anchor" href="#_use_superset_webinterface"></a>Use Superset webinterface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Superset gives the ability to execute SQL queries and build dashboards.
Open the <code>superset</code> endpoint <code>external-superset</code> in your browser (<code><a href="http://172.18.0.4:32295" class="bare">http://172.18.0.4:32295</a></code> in this case).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_1.png" alt="superset 1">
</div>
</div>
<div class="paragraph">
<p>Log in with the username <code>admin</code> and password <code>admin</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_2.png" alt="superset 2">
</div>
</div>
<div class="sect2">
<h3 id="_view_the_dashboard"><a class="anchor" href="#_view_the_dashboard"></a>View the dashboard</h3>
<div class="paragraph">
<p>On the top click on the tab <code>Dashboards</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_3.png" alt="superset 3">
</div>
</div>
<div class="paragraph">
<p>Click on the dashboard called <code>Taxi data</code>.
It might take some time until the dashboards renders all the included charts.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_4.png" alt="superset 4">
</div>
</div>
<div class="paragraph">
<p>You can clearly see the impact of Covid-19 on the taxi business.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execute_arbitrary_sql_statements"><a class="anchor" href="#_execute_arbitrary_sql_statements"></a>Execute arbitrary SQL statements</h3>
<div class="paragraph">
<p>Within Superset you can not only create dashboards but also run arbitrary SQL statements.
On the top click on the tab <code>SQL Lab</code> &#8594; <code>SQL Editor</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_5.png" alt="superset 5">
</div>
</div>
<div class="paragraph">
<p>On the left select the database <code>Trino</code>, the schema <code>demo</code> and set <code>See table schema</code> to <code>ny_taxi_data</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_6.png" alt="superset 6">
</div>
</div>
<div class="paragraph">
<p>On the right textbox enter the desired SQL statement.
If you do not want to make on up you can use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select
  format_datetime(tpep_pickup_datetime, 'YYYY/MM') as month,
  count(*) as trips,
  sum(total_amount) as sales,
  avg(duration_min) as avg_duration_min
from ny_taxi_data
group by 1
order by 1</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/demo-trino-taxi-data/superset_7.png" alt="superset 7">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The demo loaded 2.5 years of taxi trip data from New York City with 68 million records and a total size of 1GB in parquet files.
The data was put into the S3 storage.
Trino enables you to query the data via SQL.
Superset was used as a web-based frontend to execute SQL statements and build dashboards.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_where_to_go_from_here"><a class="anchor" href="#_where_to_go_from_here"></a>Where to go from here</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are multiple paths to go from here.
The following sections can give you some ideas on what to explore next.
You can find the description of the taxi data <a href="https://www1.nyc.gov/assets/tlc/downloads/pdf/data_dictionary_trip_records_yellow.pdf">on the New York City website</a>.</p>
</div>
<div class="sect2">
<h3 id="_execute_arbitrary_sql_statements_2"><a class="anchor" href="#_execute_arbitrary_sql_statements_2"></a>Execute arbitrary SQL statements</h3>
<div class="paragraph">
<p>Within Superset you can execute arbitrary SQL statements to explore the taxi data.
Can you answer the following questions by executing SQL statements?
The <a href="https://trino.io/docs/current/language.html">Trino documentation on their SQL language</a> might help you.</p>
</div>
<div class="paragraph">
<p>How many taxi trips there where in the year 2021?</p>
</div>
<details>
<summary class="title">See the answer</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select
  count(*) as trips
from ny_taxi_data
where year(tpep_pickup_datetime) = 2021</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns 30.903.982 trips.</p>
</div>
</div>
</details>
<div class="paragraph">
<p>What was the maximum amount of passengers?</p>
</div>
<details>
<summary class="title">See the answer</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select
  max(passenger_count) as max_passenger_count
from ny_taxi_data;</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns 112 passengers.</p>
</div>
<div class="paragraph">
<p>Well that&#8217;s weird.
Lets examine the passengers distribution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select
  passenger_count,
  count(*) as frequency
from ny_taxi_data
group by 1
order by 1 desc
limit 100</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"> passenger_count | frequency
-----------------+-----------
           112.0 |         1
            96.0 |         1
             9.0 |        98
             8.0 |       156
             7.0 |       229
             6.0 |   1089568
             5.0 |   1715439
             4.0 |   1052834
             3.0 |   2504112
             2.0 |   9575299
             1.0 |  48133494
             0.0 |   1454268
            NULL |   2698591</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can see that one trip had 112 and another one 96 passengers.
All the other trips start with a more "realistic" number of 9 passengers.</p>
</div>
<div class="paragraph">
<p>As a bonus question: What <strong>exactly</strong> did the large number of passenger do?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select *
from ny_taxi_data
where passenger_count &gt; 50</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"> vendorid |  tpep_pickup_datetime   |  tpep_dropoff_datetime  | duration_min | passenger_count | trip_distance | payment_type | fare_amount | tip_amount | total_amount
----------+-------------------------+-------------------------+--------------+-----------------+---------------+--------------+-------------+------------+--------------
        2 | 2021-08-01 19:47:43.000 | 2021-08-01 19:57:54.000 |           10 |           112.0 |           1.8 | Credit card  |         9.0 |       2.46 |        14.76
        2 | 2021-08-03 11:51:58.000 | 2021-08-03 12:09:29.000 |           17 |            96.0 |          1.56 | Credit card  |        11.5 |       2.22 |        17.02</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pretty cheap for that amount of people!
This probably are invalid records.</p>
</div>
</div>
</details>
<div class="paragraph">
<p>What was the highest tip (measured in percentage of the original fee) ever given?</p>
</div>
<details>
<summary class="title">See the answer</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">select
  total_amount as fee,
  tip_amount as tip,
  tip_amount / total_amount * 100 as tip_percentage
from ny_taxi_data
where total_amount &gt; 0
order by 3 desc
limit 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>returns</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"> fee  | tip  |   tip_percentage
------+------+--------------------
  4.2 | 10.0 |  238.0952380952381
 18.2 | 25.0 | 137.36263736263737
 8.24 | 9.24 | 112.13592233009709
 0.66 | 0.66 |              100.0
 0.01 | 0.01 |              100.0</code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_create_additional_dashboards"><a class="anchor" href="#_create_additional_dashboards"></a>Create additional dashboards</h3>
<div class="paragraph">
<p>You also have the possibility to create additional charts and bundle them together in a Dashboard.
Have a look at <a href="https://superset.apache.org/docs/creating-charts-dashboards/creating-your-first-dashboard#creating-charts-in-explore-view">the Superset documentation</a> on how to do that.</p>
</div>
</div>
<div class="sect2">
<h3 id="_load_additional_data"><a class="anchor" href="#_load_additional_data"></a>Load additional data</h3>
<div class="paragraph">
<p>You can use the MinIO webinterface to upload additional data.
As an alternative you can use the S3 API with an S3 client like <a href="https://s3tools.org/s3cmd">s3cmd</a>.
It is recommended to put the data into a folder (prefix) in the <code>demo</code> bucket.</p>
</div>
<div class="paragraph">
<p>Have a look at the defined tables inside the <code>hive</code>.<code>demo</code> schema on how to inform Trino about the newly available data.</p>
</div>
<details>
<summary class="title">Table definitions</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">show create table hive.demo.ny_taxi_data_raw</code></pre>
</div>
</div>
<div class="paragraph">
<p>produces something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE IF NOT EXISTS hive.demo.ny_taxi_data_raw (
  VendorID BIGINT,
  tpep_pickup_datetime TIMESTAMP,
  tpep_dropoff_datetime TIMESTAMP,
  passenger_count DOUBLE,
  trip_distance DOUBLE,
  payment_type BIGINT,
  Fare_amount DOUBLE,
  Tip_amount DOUBLE,
  Total_amount DOUBLE
) WITH (
  external_location = 's3a://demo/ny-taxi-data/raw/',
  format = 'parquet'
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to transform or filter your data in any way before using it e.g. in Superset you can create a view as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">show create view hive.demo.ny_taxi_data</code></pre>
</div>
</div>
<div class="paragraph">
<p>produces something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">create or replace view hive.demo.ny_taxi_data as
select
  vendorid,
  tpep_pickup_datetime,
  tpep_dropoff_datetime,
  date_diff('minute', tpep_pickup_datetime, tpep_dropoff_datetime) as duration_min,
  passenger_count,
  trip_distance,
  case payment_type when 1 then 'Credit card' when 2 then 'Cash' when 3 then 'No charge' when 4 then 'Dispute' when 6 then 'Voided trino' else 'Unknown' end as payment_type,
  fare_amount,
  tip_amount,
  total_amount
from hive.demo.ny_taxi_data_raw
where tpep_pickup_datetime &gt;= from_iso8601_timestamp('2019-12-01T00:00:00')
and tpep_pickup_datetime &lt;= from_iso8601_timestamp('2022-05-31T00:00:00')</code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_connect_to_trino_via_cli_python_or_dbeaver"><a class="anchor" href="#_connect_to_trino_via_cli_python_or_dbeaver"></a>Connect to Trino via CLI, Python or DBeaver</h3>
<div class="paragraph">
<p>If you prefer running your SQL statements via command-line, a Python script or a graphical Database manager like DBeaver please have a look at the <a href="https://trino.io/docs/current/client.html">the Trino documentation</a> on how to do that.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
    </div>
</div>
<footer class="footer">
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
